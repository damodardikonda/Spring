package Services_Cls;

import org.springframework.stereotype.Service;

import java.util.Arrays;

import org.springframework.mail.MailException;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.mail.javamail.MimeMessagePreparator;
@Service
public class MailService {

	private final JavaMailSender mailsender; // Interface
	
	@Async
	public void sendMail(NotificationEmail notificationEmail) {
		MimeMessagePreparator messagepreparator = mimeMessage ->{
			MimeMessageHelper messagehelper =new MimeMessageHelper(mimeMessage);
			messagehelper.setFrom("attendance007@gmail.com");
			messagehelper.setTo(notificationEmail.getRecipient());
			messagehelper.setSubject(notificationEmail.getSubject());
			messagehelper.setText(notificationEmail.getBody());

		};
		
		try {
			mailsender.send(messagepreparator);
			log.info("Activation email sent!!");
		} catch (MailException e) {
			log.error("Exception occurred when sending mail to "
					+ notificationEmail.getRecipient()
					+ Arrays.toString(e.getStackTrace()));

			throw new Exception(
					"Exception occurred when sending mail to " + notificationEmail.getRecipient());
		}
	}
}
	
	

